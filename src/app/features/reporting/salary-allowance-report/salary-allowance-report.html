<!-- BACKDROP -->
<div class="popup-backdrop" (click)="closePopup()"></div>

<!-- POPUP -->
<div class="popup-container">

  <!-- HEADER -->
  <div class="popup-header">
    <h2>B√°o c√°o l∆∞∆°ng & ph·ª• c·∫•p</h2>
    <button class="close-btn" (click)="closePopup()">‚úï</button>
  </div>

  <!-- BODY -->
  <div class="popup-body">

    <!-- üîΩ N·ªòI DUNG B·∫†N G·ª¨I (GI·ªÆ NGUY√äN) -->
    <div class="salary-report">

      <!-- FILTER -->
      <div class="filter-box">
      <div class="filter-item">
        <label>Th·ªùi gian</label>
        <select [(ngModel)]="period">
      <option value="month">Th√°ng n√†y</option>
      <option value="quarter">Qu√Ω n√†y</option>
      <option value="year">NƒÉm nay</option>
    </select>

  </div>

  <div class="filter-item">
    <label>Ph√≤ng ban</label>
    <select [(ngModel)]="department">
      <option [ngValue]="undefined">T·∫•t c·∫£ ph√≤ng ban</option>
      <option [ngValue]="1">Nh√¢n s·ª±</option>
      <option [ngValue]="2">IT</option>
      <option [ngValue]="3">K·∫ø to√°n</option>
    </select>
  </div>

  <div class="filter-item">
    <label>Ch·ª©c v·ª•</label>
    <select [(ngModel)]="role">
      <option [ngValue]="undefined">T·∫•t c·∫£ c√°c ch·ª©c v·ª•</option>
      <option value="STAFF">Nh√¢n vi√™n</option>
      <option value="MANAGER">Qu·∫£n l√Ω</option>
    </select>
  </div>

  <button class="btn-filter" (click)="onFilter()">
    üîç L·ªçc d·ªØ li·ªáu
  </button>
</div>


      <!-- SUMMARY -->
      <div class="summary">

        <!-- T·ªïng qu·ªπ l∆∞∆°ng -->
        <div class="summary-card">
          <span class="icon">$</span>
          <div>
            <p>T·ªïng qu·ªπ l∆∞∆°ng</p>
            <h3>{{ formatMoney(kpi?.tongQuyLuong) }}</h3>
          </div>
        </div>

        <!-- L∆∞∆°ng c∆° b·∫£n -->
        <div class="summary-card green">
          <span class="icon">üí≥</span>
          <div>
            <p>L∆∞∆°ng c∆° b·∫£n</p>
            <h3>{{ formatMoney(kpi?.luongCoBan) }}</h3>
          </div>
        </div>

        <!-- T·ªïng ph·ª• c·∫•p -->
        <div class="summary-card orange">
          <span class="icon">üéÅ</span>
          <div>
            <p>T·ªïng ph·ª• c·∫•p</p>
            <h3>{{ formatMoney(kpi?.phuCap) }}</h3>
          </div>
        </div>

        <!-- Th∆∞·ªüng -->
        <div class="summary-card pink">
          <span class="icon">üèÜ</span>
          <div>
            <p>Th∆∞·ªüng</p>
            <h3>{{ formatMoney(kpi?.thuong) }}</h3>
          </div>
        </div>

      </div>


      <!-- CHART -->
   <div class="chart-row">

        <!-- BAR CHART -->
        <div class="chart-box">
            <h4>Qu·ªπ l∆∞∆°ng theo ph√≤ng ban</h4>
            <canvas #barChart ></canvas>
        </div>

        <!-- DONUT CHART -->
        <div class="chart-box">
            <h4>C∆° c·∫•u l∆∞∆°ng</h4>
            <canvas #donutChart></canvas>
        </div>

        </div>


      <!-- TABLE -->
      <h3 class="section-title">Chi ti·∫øt l∆∞∆°ng theo nh√¢n vi√™n</h3>

<table class="salary-table">
  <thead>
    <tr>
      <th>Nh√¢n vi√™n</th>
      <th>Ph√≤ng ban</th>
      <th>L∆∞∆°ng c∆° b·∫£n</th>
      <th>Ph·ª• c·∫•p</th>
      <th>Th∆∞·ªüng</th>
      <th>T·ªïng thu nh·∫≠p</th>
    </tr>
  </thead>

  <tbody>
    <tr *ngFor="let emp of employeeSalaries">
      <td>
        <strong>{{ emp.tenNhanVien }}</strong>
      </td>
      <td>{{ emp.phongBan }}</td>
      <td>{{ formatNumber(emp.luongCoBan) }}</td>
      <td>{{ formatNumber(emp.phuCap) }}</td>
      <td>{{ formatNumber(emp.thuong) }}</td>
      <td class="bold">{{ formatNumber(emp.tong) }}</td>
    </tr>

    <!-- Kh√¥ng c√≥ d·ªØ li·ªáu -->
    <tr *ngIf="employeeSalaries.length === 0">
      <td colspan="6" style="text-align:center; color:#9ca3af">
        Kh√¥ng c√≥ d·ªØ li·ªáu ph√π h·ª£p
      </td>
    </tr>
  </tbody>
</table>


    </div>
  </div>
</div>
